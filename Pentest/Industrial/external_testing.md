## External Testing
External penetration testing refers to testing Internet-facing environments from the Internet. Testing can include traditional business IT systems, as well as ICS systems. However, because we want to avoid actively penetration testing production ICS networks and devices, even if they are directly accessible from the Internet, what we are referring to here is a common strategy to use Internet-facing adjacent networks, such as the business network, as a pathway to the ICS network. (The specifics of penetration testing ICS networks and devices directly, which also applies to those that are Internet facing, will be covered in detail in later chapters.) The idea is that in the absence of Internet-facing ICS networks and devices (which should be the case), attackers can attempt to gain access to these other business networks and work their way into the ICS networks through connected paths.
As mentioned, the fundamental skills required to perform external penetration testing are the same, regardless of what environment is being tested, and they typically include, though are not limited to, the following common methodologies and sets of tools:

  * Standard penetration-testing methodology and skillset:
  * Footprinting (“recon”) as mentioned earlier
  * Host discovery, port scanning, and service numeration
  * Vulnerability mapping (matching discovered services and versions with known vulnerabilities)
  * Exploiting known vulnerabilities (which may also include exploit development, testing, and tuning)
  * Zero-day vulnerability discovery and exploitation (depending on scope and time, since this requires a much more specialized and advanced skillset)
  * Common penetration testing tools:
  * Kali Linux is a specialized version of Linux designed for penetration testing and contains most of the tools required for just about any penetration testing task (https://www.kali.org/).
  * A complete listing of the tools found within Kali (which also serves as a rather comprehensive list of penetration testing tools in general) is listed by category at http://tools.kali.org/tools-listing.
  * SamuraiSTFU (http://www.samuraistfu.org/) is a penetration testing distribution much like Kali, but it is specifically designed for penetration testing ICS environments.
  * Penetration testing and exploit frameworks are a core component of penetration testing. They save time and provide automation and a single repository for many of the required penetration-testing tools and techniques (including exploit development). 
  
Every one of these frameworks also now offers ICS/SCADA exploits.
  
  * Metasploit   (https://www.metasploit.com/) The original “pioneer” for exploit frameworks and considered an industry standard, Metasploit offers free and commercial versions.
  * CORE Impact   (https://www.coresecurity.com/core-impact) A commercial penetration-testing and exploit framework tool similar to Metasploit. Impact comes with a significant price tag but is a preferred framework for professional penetration-testing teams with the budget for it.
  * Immunity CANVAS   (https://www.immunityinc.com/products/canvas/index.html) A commercial penetration-testing and exploit framework tool similar to Metasploit. CANVAS also comes with a significant cost, and just like Impact it is preferred by many professional penetration-testing teams with the budget for it.
  * Exploit Pack   (http://exploitpack.com/) The newest member of the penetration testing and exploit frameworkDisassemblers and debuggers (gdb, IDA Pro, Immunity Debugger, WinDbg)
  * Fuzzers (Sulley, Peach Fuzzer, Codenomicon)
  * Packet crafting and manipulation tools (Scapy, Nping, Netcat)

It’s worth mentioning that regardless of all the cool tools and techniques that exist, in our experience, the most successful attack vectors in ICS environments still remain poorly secured workstations, usually with weak passwords that are easily guessed, cracked, or brute-forced; remote access services like Remote Desktop Protocol (RDP) and SSH; and social engineering techniques. It just goes to show that all of the technical security and patching in the world can’t protect your systems as long as your employees remain the weakest link. The German steel mill attack mentioned in Chapter 1 used social engineering (phishing) as an initial attack vector. family, Exploit Pack is very affordable, yet shows great promise with a polished interface and functionality that rivals more expensive competitors, along with an expansive and growing exploit collection.

#### Resources and bibliography:

  * **HACKING EXPOSED: ICS and SCADA Security Secrets and Solutions** by *C. E. Bodungen, B. L. Singer, A. Shbeeb, S. Hilt, K. Wilhoit*